import{u as U,f as tl,h as el,i as M,j as il,P as al,t as nl,k as sl,l as A,m as R,p as ol,q as Y,s as e,v as cl,R as T,x as hl,y as rl,z as ml,C as ul,A as wl,B as pl,D as vl,E as dl,F as zl,G as x,H as yl,I as fl,J as gl,K as $,L as I,M as kl}from"./app-C9skI7Gy.js";const bl=["/","/zh/assets.html","/zh/de.html","/zh/","/zh/md.html","/zh/sitehelp.html","/zh/account/apkxa.html","/zh/account/google.html","/zh/account/","/zh/account/ios.html","/zh/account/twitch.html","/zh/dev/","/zh/branch/","/zh/intl/catalog.html","/zh/intl/","/zh/markdown/","/zh/branch/mw-card/","/zh/intl/mw/game-info.html","/zh/intl/mw/","/zh/intl/mw/mw-game-lottery.html","/zh/intl/mw/mw-press.html","/zh/intl/mwt/game-info.html","/zh/intl/mwt/","/zh/markdown/other/","/zh/intl/mw/collection/cn-warships.html","/zh/intl/mw/collection/dpm.html","/zh/intl/mw/collection/egg.html","/zh/intl/mw/collection/events-less.html","/zh/intl/mw/collection/game-modes.html","/zh/intl/mw/collection/","/zh/intl/mw/collection/lj.html","/zh/intl/mw/collection/market.html","/zh/intl/mw/collection/musk.html","/zh/intl/mw/collection/mwben.html","/zh/intl/mw/collection/news.html","/zh/intl/mw/column/","/zh/intl/mw/download/app.html","/zh/intl/mw/download/","/zh/intl/mw/download/mod.html","/zh/intl/mw/download/pc.html","/zh/intl/mw/download/sys.html","/zh/intl/mw/download/zg.html","/zh/intl/mw/official/bp.html","/zh/intl/mw/official/bs.html","/zh/intl/mw/official/","/zh/intl/mw/official/jd.html","/zh/intl/mw/official/lt.html","/zh/intl/mw/official/qt.html","/zh/intl/mw/official/sc.html","/zh/intl/mw/official/sd.html","/zh/intl/mw/official/wf.html","/zh/intl/mw/official/yj.html","/zh/intl/mw/official/zb.html","/zh/intl/mw/official/zd.html","/zh/intl/mw/official/zh.html","/zh/intl/mw/official/zy.html","/zh/intl/mw/skills/cyct.html","/zh/intl/mw/skills/game.html","/zh/intl/mw/skills/","/zh/intl/mw/skills/mom.html","/zh/intl/mw/skills/mw-rules.html","/zh/intl/mw/skills/newplayer.html","/zh/intl/mw/skills/stan-bilibili.html","/zh/intl/mw/skills/x51.html","/zh/intl/mwt/collection/ammo.html","/zh/intl/mwt/collection/","/zh/intl/mwt/collection/link.html","/zh/intl/mwt/download/","/zh/intl/mwt/download/mod.html","/zh/intl/mw/collection/balance-log/","/zh/intl/mw/collection/balance-log/mw68.html","/zh/intl/mw/collection/balance-log/mw70.html","/zh/intl/mw/collection/balance-log/mw77.html","/zh/intl/mw/collection/balance-log/mw78.html","/zh/intl/mw/collection/balance-log/mw79.html","/zh/intl/mw/collection/balance-log/mw80.html","/zh/intl/mw/collection/balance-log/mw82.html","/zh/intl/mw/collection/pan-spatial/desc.html","/zh/intl/mw/collection/pan-spatial/","/zh/intl/mw/collection/realitymw/bomber.html","/zh/intl/mw/collection/realitymw/fighter.html","/zh/intl/mw/collection/realitymw/helicopter.html","/zh/intl/mw/collection/realitymw/","/zh/intl/mw/collection/realitymw/strike-fighters.html","/zh/intl/mw/collection/realitymw/uav.html","/zh/intl/mw/collection/realitymw2/cruiser.html","/zh/intl/mw/collection/realitymw2/destroyer.html","/zh/intl/mw/collection/realitymw2/","/zh/intl/mw/collection/tournament/cn.html","/zh/intl/mw/collection/tournament/ct.html","/zh/intl/mw/collection/tournament/ctto.html","/zh/intl/mw/collection/tournament/","/zh/intl/mw/collection/pan-spatial/aircraft/dragon.html","/zh/intl/mw/collection/pan-spatial/aircraft/","/zh/intl/mw/collection/pan-spatial/aircraft/jacknife.html","/zh/intl/mw/collection/pan-spatial/aircraft/killswitch.html","/zh/intl/mw/collection/pan-spatial/aircraft/rhombat.html","/zh/intl/mw/collection/pan-spatial/aircraft/spyder.html","/zh/intl/mw/collection/pan-spatial/ships/argonas.html","/zh/intl/mw/collection/pan-spatial/ships/","/zh/intl/mw/collection/pan-spatial/ships/redrum.html","/zh/intl/mw/collection/pan-spatial/ships/teton.html","/404.html"],Hl="SEARCH_PRO_QUERY_HISTORY",z=U(Hl,[]),Rl=()=>{const{queryHistoryCount:i}=x,a=i>0;return{enabled:a,queryHistory:z,addQueryHistory:n=>{a&&(z.value=Array.from(new Set([n,...z.value.slice(0,i-1)])))},removeQueryHistory:n=>{z.value=[...z.value.slice(0,n),...z.value.slice(n+1)]}}},E=i=>bl[i.id]+("anchor"in i?`#${i.anchor}`:""),xl="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:_}=x,y=U(xl,[]),Ql=()=>{const i=_>0;return{enabled:i,resultHistory:y,addResultHistory:a=>{if(i){const n={link:E(a),display:a.display};"header"in a&&(n.header=a.header),y.value=[n,...y.value.slice(0,_-1)]}},removeResultHistory:a=>{y.value=[...y.value.slice(0,a),...y.value.slice(a+1)]}}},ql=i=>{const a=ul(),n=M(),Q=wl(),o=A(0),k=R(()=>o.value>0),p=pl([]);return vl(()=>{const{search:v,terminate:q}=dl(),f=zl(r=>{const g=r.join(" "),{searchFilter:S=w=>w,splitWord:C,suggestionsFilter:F,...d}=a.value;g?(o.value+=1,v(r.join(" "),n.value,d).then(w=>S(w,g,n.value,Q.value)).then(w=>{o.value-=1,p.value=w}).catch(w=>{console.warn(w),o.value-=1,o.value||(p.value=[])})):p.value=[]},x.searchDelay-x.suggestDelay);Y([i,n],([r])=>f(r),{immediate:!0}),yl(()=>{q()})}),{isSearching:k,results:p}};var Cl=tl({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(i,{emit:a}){const n=el(),Q=M(),o=il(al),{enabled:k,addQueryHistory:p,queryHistory:v,removeQueryHistory:q}=Rl(),{enabled:f,resultHistory:r,addResultHistory:g,removeResultHistory:S}=Ql(),C=k||f,F=nl(i,"queries"),{results:d,isSearching:w}=ql(F),s=sl({isQuery:!0,index:0}),m=A(0),u=A(0),P=R(()=>C&&(v.value.length>0||r.value.length>0)),L=R(()=>d.value.length>0),D=R(()=>d.value[m.value]||null),B=()=>{const{isQuery:l,index:t}=s;t===0?(s.isQuery=!l,s.index=l?r.value.length-1:v.value.length-1):s.index=t-1},G=()=>{const{isQuery:l,index:t}=s;t===(l?v.value.length-1:r.value.length-1)?(s.isQuery=!l,s.index=0):s.index=t+1},J=()=>{m.value=m.value>0?m.value-1:d.value.length-1,u.value=D.value.contents.length-1},K=()=>{m.value=m.value<d.value.length-1?m.value+1:0,u.value=0},V=()=>{u.value<D.value.contents.length-1?u.value+=1:K()},N=()=>{u.value>0?u.value-=1:J()},j=l=>l.map(t=>kl(t)?t:e(t[0],t[1])),W=l=>{if(l.type==="customField"){const t=fl[l.index]||"$content",[c,H=""]=gl(t)?t[Q.value].split("$content"):t.split("$content");return l.display.map(h=>e("div",j([c,...h,H])))}return l.display.map(t=>e("div",j(t)))},b=()=>{m.value=0,u.value=0,a("updateQuery",""),a("close")},X=()=>k?e("ul",{class:"search-pro-result-list"},e("li",{class:"search-pro-result-list-item"},[e("div",{class:"search-pro-result-title"},o.value.queryHistory),v.value.map((l,t)=>e("div",{class:["search-pro-result-item",{active:s.isQuery&&s.index===t}],onClick:()=>{a("updateQuery",l)}},[e($,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},l),e("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),q(t)}})]))])):null,Z=()=>f?e("ul",{class:"search-pro-result-list"},e("li",{class:"search-pro-result-list-item"},[e("div",{class:"search-pro-result-title"},o.value.resultHistory),r.value.map((l,t)=>e(T,{to:l.link,class:["search-pro-result-item",{active:!s.isQuery&&s.index===t}],onClick:()=>{b()}},()=>[e($,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[l.header?e("div",{class:"content-header"},l.header):null,e("div",l.display.map(c=>j(c)).flat())]),e("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),S(t)}})]))])):null;return ol("keydown",l=>{if(i.isFocusing){if(L.value){if(l.key==="ArrowUp")N();else if(l.key==="ArrowDown")V();else if(l.key==="Enter"){const t=D.value.contents[u.value];p(i.queries.join(" ")),g(t),n.push(E(t)),b()}}else if(f){if(l.key==="ArrowUp")B();else if(l.key==="ArrowDown")G();else if(l.key==="Enter"){const{index:t}=s;s.isQuery?(a("updateQuery",v.value[t]),l.preventDefault()):(n.push(r.value[t].link),b())}}}}),Y([m,u],()=>{var l;(l=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||l.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{class:["search-pro-result-wrapper",{empty:i.queries.length?!L.value:!P.value}],id:"search-pro-results"},i.queries.length?w.value?e(cl,{hint:o.value.searching}):L.value?e("ul",{class:"search-pro-result-list"},d.value.map(({title:l,contents:t},c)=>{const H=m.value===c;return e("li",{class:["search-pro-result-list-item",{active:H}]},[e("div",{class:"search-pro-result-title"},l||o.value.defaultTitle),t.map((h,ll)=>{const O=H&&u.value===ll;return e(T,{to:E(h),class:["search-pro-result-item",{active:O,"aria-selected":O}],onClick:()=>{p(i.queries.join(" ")),g(h),b()}},()=>[h.type==="text"?null:e(h.type==="title"?hl:h.type==="heading"?rl:ml,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[h.type==="text"&&h.header?e("div",{class:"content-header"},h.header):null,e("div",W(h))])])})])})):o.value.emptyResult:C?P.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{Cl as default};
